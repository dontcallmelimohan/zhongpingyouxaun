<!DOCTYPE html>

<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>注册 - 众评优选</title>
<link href="../libs/bootstrap/5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
<link href="../libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">
<link href="/css/style.css" rel="stylesheet"/>
<style>
        body, html { height: 100%; }
        .register-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: calc(100vh - 120px);
        }
    </style>
</link></head>
<body>
<header>
<nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
<div class="container">
<a class="navbar-brand fw-bold" href="/index.html">
<i class="fa-solid fa-star-half-stroke"></i>
                    众评优选
                </a>
</div>
</nav>
</header>
<main class="register-container">
<div class="col-md-6 col-lg-5">
<div class="card shadow-lg">
<div class="card-body p-4 p-md-5">
<h2 class="card-title text-center mb-4">创建您的账户</h2>
<form id="registerForm">
<div class="form-floating mb-3">
<input class="form-control" id="username" placeholder="用户名" required="" type="text"/>
<label for="username">用户名</label>
</div>
<div class="form-floating mb-3">
<input class="form-control" id="email" placeholder="邮箱地址" required="" type="email"/>
<label for="email">邮箱地址</label>
</div>
<div class="form-floating mb-3">
<input class="form-control" id="password" placeholder="密码" required="" type="password"/>
<label for="password">密码 (至少6位)</label>
</div>
<div class="d-grid">
<button class="btn btn-primary btn-lg" type="submit">注册</button>
</div>
<div class="mt-3 d-none" id="messageDiv" role="alert"></div>
</form>
<hr class="my-4"/>
<div class="text-center">
<p class="mb-0">已经有账户了? <a href="login.html">前往登录</a></p>
</div>
</div>
</div>
</div>
</main>

<script>
        document.addEventListener('DOMContentLoaded', () => {
            const registerForm = document.getElementById('registerForm');
            const messageDiv = document.getElementById('messageDiv');

            registerForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                messageDiv.className = 'mt-3 d-none';

                const username = document.getElementById('username').value;
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;

                try {
                    const response = await fetch('/api/auth/signup', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ username, email, password })
                    });

                    const data = await response.json();

                    if (response.ok) {
                        messageDiv.className = 'alert alert-success';
                        messageDiv.textContent = data.message + ' 正在跳转到登录页面...';
                        setTimeout(() => {
                            window.location.href = 'login.html';
                        }, 2000);
                    } else {
                        messageDiv.className = 'alert alert-danger';
                        messageDiv.textContent = data.message || '注册失败，请检查您的输入。';
                    }
                } catch (error) {
                    messageDiv.className = 'alert alert-danger';
                    messageDiv.textContent = '网络错误，请稍后重试。';
                }
            });
        });
    </script>
</body>
</html>